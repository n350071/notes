# 2023-11-08_lb_データ自動収集.md
## 概要

## 目標
- 30%で作る
- 段階的詳細化法
  - input: 必須
  - process: なるべく省略して、リスクの高いところだけ実施する
  - output: 必須
- 作業してきました感を出す
- 古賀さんが用意してくれたデータを使う

## 古賀さんが用意してくれたデータ
- 2件、フェイクで添付の申請を作成いたしました。こちらで大丈夫でしょうか。
### マネーフォワードクラウド経費
- 下書きで1件(4413)
  - プロジェクトが入っている10月の項目
  - 入っていな10月の項目
  - プロジェクトが入っていて7月の項目
- 承認済みで1件(2779)
  - 承認済みの申請で1項目を編集して、プロジェクトを入れました。

## 仕様
### input
- 📌収集開始ボタン at staff/manage/dashboard
### process
- 収集
  - LbEシステム
    - ⛔️案件（mock）
    - ⛔️GL経費（mock）
  - kintone
    - ⛔️売上高(programs#earnings)
    - ⛔️クライアント（mock）
    - ⛔️エージェント（mock）
    - ⛔️担当者（mock）
    - ⛔️貢献度（mock）
  - MF経費
    - 📌社員経費情報
  - ❌Google Sheet クレカ情報（まだ実装しない）
- 📌蓄積/更新
  - （インターフェースのみ作る）
- 📌Snapshotコピー
  - Snapshot直接生成
    - 参考create_sample_manage_snapshot_data.rb
    - MF社員経費情報のdirect_cost
### output
- ✅staff/manage/analytics/snapshot/programs
- ✅staff/manage/analytics/snapshot/programs/:id

## 気づいたこと
### データ構造の修正
- 貢献度はkintoneから収集するので、マスタ不要
- 売上原価と従業員の関連付けは、不要っぽい（売上原価全体の按分ではなく、個別の経費等のデータと従業員）
- snapshotのitem表現は、なにか気になる

