## ã‚¢ãƒ¡ãƒ¼ãƒçµŒå–¶ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
### ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³
| ver | ã‚¿ã‚¤ãƒˆãƒ«  | å†…å®¹ |
| --- | --- | --- |
| âœ…v2.0.0 | æ¡ˆä»¶ç²—åˆ©ã®è©•ä¾¡ | æ‰‹å‹•ã§ãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥ã™ã‚Œã°æ¡ˆä»¶ç²—åˆ©ã‚’è©•ä¾¡ã§ãã‚‹<br /> ãƒªãƒªãƒ¼ã‚¹äºˆå®š |
| ğŸ“Œv2.0.1 | æ¡ˆä»¶ç²—åˆ©ã®ãƒ‡ãƒ¼ã‚¿è‡ªå‹•åé›† | ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•åé›†ç¯„å›²ã‚’åºƒã’ã‚‹<br />ã©ã“ã¾ã§ã®ç²¾åº¦ã«ã™ã‚‹ã‹ã¯é€²æ—ã¨ã®å…¼ã­åˆã„ã§èª¿æ•´ã™ã‚‹ |
| v2.0.2 | æ¡ˆä»¶ç²—åˆ©ã®è©•ä¾¡ã®è¦‹ãŸç›®å‘ä¸Š | ã‚°ãƒ©ãƒ•, å†…è¨³ã®æ•´ç†ãªã©è¡¨ç¤ºå†…å®¹ãŒç›´è¦³çš„ã«ã‚ã‹ã‚‹ã‚ˆã†ã«å£²ä¸ŠåŸä¾¡ã®ç´°ç›®ã‚¿ã‚¤ãƒ—ã‚’è¨­å®šã™ã‚‹<br /> ï¼ˆç¯„å›²å¤–ã ã£ãŸã¯ãšã ã‘ã©ã‚‚..ä½œã£ã¦ã¿ãŸã‚‰æ¬²ã—ããªã£ãŸã®ã§ææ¡ˆã€‚ãŸã ã—ã€v2.0.4ã®ã‚ã¨ã§ã‚‚ã„ã„ã‹ã‚‚ï¼Ÿï¼‰ |
| v2.0.3 | äººã®è²¢çŒ®åº¦ã®è©•ä¾¡ | æ¡ˆä»¶ç²—åˆ©ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ã€ã‚¹ã‚¿ãƒƒãƒ•ã®è²¢çŒ®åº¦ã‚’è©•ä¾¡ã™ã‚‹ |
| v2.0.4 | ãƒãƒ¼ãƒ ã®è²¢çŒ®åº¦ã®è©•ä¾¡ | ã‚¹ã‚¿ãƒƒãƒ•ã®è²¢çŒ®åº¦ã‚’åˆè¨ˆã—ã¦ã€ãƒãƒ¼ãƒ ã®è²¢çŒ®åº¦ã‚’è©•ä¾¡ã™ã‚‹ |
| v2.0.5 | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ, ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç²—åˆ©ç‡ã®è©•ä¾¡ | |
| --- | --- | --- |
| v2.0.a | ç²—åˆ©ã®ç²¾åº¦å‘ä¸Š | +-15%ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ |
| v2.0.b | ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãŒã§ãã‚‹ã¾ã§ã®å‡¦ç½® | ... |
| v2.0.c | ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ | ... |

### ä¼šè­°ä¸­ã®æŒ‡æ‘˜ã‚„è¿½åŠ äº‹é …
- ...
- ...


### ãƒ¡ãƒ¢
- è–„ãä¸­é€”åŠç«¯ã«ã™ã‚‹ã‹ã€æ¡ˆä»¶ç®¡ç†ã‚’ãã¡ã‚“ã¨ã‚„ã‚‹ã‹ï¼Ÿ
- æ¡ˆä»¶ç®¡ç†ã‚’ãã¡ã‚“ã‚„ã£ãŸã»ã†ãŒã„ã„ç†ç”±
  - æ¡ˆä»¶ã®ç²—åˆ©ç‡ã‚’ãªã‚‹ã¹ãç²¾åº¦é«˜ã‚ãŸã»ã†ãŒã„ã„ã‚ˆã­ï¼Ÿ
  - 1æœˆä¸­ã‹ã‚‰åˆ¶åº¦ã¨ã—ã¦å§‹ã‚ã‚‹ã¯ã„ã„
  - 12æœˆã¯æ¡ˆä»¶ã‚’çµ‚ã‚ã‚‰ã›ã¾ã—ã‚‡ã†
    - æ¡ˆä»¶ã®åç›ŠãŒã‚ã‹ã‚Œã°ã€è©•ä¾¡ã¯ã§ãã‚‹ï¼ˆèª°ãŒå‚ç”»ã—ã¦ãŸã‹ï¼Ÿã¯ã‚ã‹ã‚‹ã¯ãšã ã‹ã‚‰ï¼‰
- è–„ãä¸­é€”åŠç«¯
  - æ¡ˆä»¶ã®ç²—åˆ©ç‡é©å½“ã§ã€äººãƒ»ãƒãƒ¼ãƒ ã®è©•ä¾¡ã§ãã‚‹ã‚“ã ã£ã‘ï¼Ÿ


### v2.0.1 æ¡ˆä»¶ç²—åˆ©ã®ãƒ‡ãƒ¼ã‚¿è‡ªå‹•åé›†
- Program(æ¡ˆä»¶)
  - ğŸ“Œæ¡ˆä»¶ã®ç· ã‚å‡¦ç†(èª°ã‹ãŒç· ã‚ã‚‹ã¨ã€è§£é™¤ã§ããªã„ä»•çµ„ã¿ï¼Ÿãã‚Œã¨ã‚‚å…¨å“¡Approveã•ã‚ŒãŸã‚‰ç· ã‚ï¼Ÿ)
- fetch
  - from lbe_system:
    - ğŸ“Œç· ã‚å‡¦ç†ã•ã‚ŒãŸæ¡ˆä»¶ã ã‘ã‚’å–å¾—ã™ã‚‹
  - from kintone:
    - âœ…å£²ä¸Šé«˜å–å¾—ä¿å­˜æ¸ˆã¿
    - ğŸ“ŒParticipant ã‚’å–å¾—ã™ã‚‹
  - from mfçµŒè²»:
    - âœ…çµŒè²»æƒ…å ±å–å¾—ä¿å­˜æ¸ˆã¿
  - âœ…from mfçµŒè²»ã®äº‹å‰ç”³è«‹ã®æŒ¯è¾¼ä¾é ¼
  - âœ…from GSheet
- Sync
  - Manage::Programã®ç²¾ç·»åŒ–
    - âœ…event_dateã®è¿½åŠ 
    - âœ…kintone_codeã®ä¸€æ„åˆ¶ç´„
  - DirectCostã®ç²¾ç·»åŒ–
    - âœ…MFã®ãƒšãƒ¼ã‚¸å¯¾å¿œ
    - âœ…DirectCostã®ä¸€æ„åˆ¶ç´„ã‚’ã¤ã‘ã‚‹
    - âœ…LbEã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰åé›†ã™ã‚‹ãƒ‡ãƒ¼ã‚¿é …ç›®ã‚’ç¢ºèªã™ã‚‹
    - âœ…ç¨æŠœãä¾¡æ ¼ã®è¨ˆç®—ã¨ä¿å­˜ï¼ˆç«¯æ•°ã¯ã€åˆ‡ã‚Šä¸‹ã’ï¼‰
    - âœ…MFã®AdvancedPaymentã‚’åŒæœŸã•ã›ãªã„
    - âœ…MFçµŒè²»ã‹ã‚‰ã¯ã€å‹˜å®šç§‘ç›®ã‚’åŒæœŸã•ã›ã‚‹
    - âœ…google sheetã‹ã‚‰ã®å£²ä¸ŠåŸä¾¡ã®ç™»éŒ²
- Analitics
  - ğŸ“Œå‚åŠ è€…å£²ä¸Šå˜ä¾¡ï¼å£²ä¸Šï¼å‚åŠ è€…æ•° ã‚’è¨ˆç®—ã—ã¦ã€ã©ã“ã‹ã«ä¿å­˜ã—ã¦ã€è¡¨ç¤ºã™ã‚‹
  - ğŸ“Œå‚åŠ è€…åˆ©ç›Šå˜ä¾¡ï¼ç²—åˆ©ï¼å‚åŠ è€…æ•° ã‚’è¨ˆç®—ã—ã¦ã€ã©ã“ã‹ã«ä¿å­˜ã—ã¦ã€è¡¨ç¤ºã™ã‚‹
- ä¸å…·åˆ
  - âœ…kintone_codeã‚’æ›´æ–°ã—ãŸã¨ãã«ã€ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆãŒç™ºç”Ÿã™ã‚‹

### v2.0.2 æ¡ˆä»¶ç²—åˆ©ã®è©•ä¾¡ã®è¦‹ãŸç›®å‘ä¸Š
- âœ…æ¡ˆä»¶ã‚’æœˆåˆ¥ã§çµã‚Šè¾¼ã¿è¡¨ç¤ºã™ã‚‹ï¼Ÿ
- ğŸ¤”è¡¨ç¤ºé …ç›®ã®èª¿æ•´
- ğŸ¤”å£²ä¸ŠåŸä¾¡ã®é …ç›®ã‚„ã¾ã¨ã‚ã‹ãŸ
- ğŸ¤”MFçµŒè²»ã®å¾“æ¥­å“¡ã¨ã€LbESystemã®å¾“æ¥­å“¡ã‚’ã€member_idã§ç´ä»˜ã‘ã‚‹ï¼Ÿ

### v2.0.3 äººã®è²¢çŒ®åº¦ã®è©•ä¾¡
- ä»•æ§˜æ¤œè¨
  - ğŸ¤”kintoneä¸Šã§ã®å¾“æ¥­å“¡ã¨ã€LbE_Systemä¸Šã§ã®å¾“æ¥­å“¡ã‚’ã©ã®ã‚ˆã†ã«ä¸€è‡´ã•ã›ã‚‹ã‹ï¼Ÿï¼ˆåå‰ã¯æºã‚Œãã†ï¼‰
- fetch
  - ğŸ“Œkintoneã®å¾“æ¥­å“¡ã‚’åé›†ã™ã‚‹ï¼ˆkintoneä¸Šã§ã®ä»•æ§˜ã‚‚æ¤œè¨ãŒå¿…è¦ãã†, lbe_systemä¸Šã§ã®å¾“æ¥­å“¡IDã‚’ã‚‚ãŸã›ã‚‹ã¨ã‹ï¼‰
  - ğŸ“Œkintoneã®å¾“æ¥­å“¡ã®è²¢çŒ®åº¦ã‚’åé›†ã™ã‚‹ï¼ˆkintoneä¸Šã§ã®ä»•æ§˜ã‚‚æ¤œè¨ãŒå¿…è¦ãã†ï¼‰
- sync
  - ğŸ“Œå¾“æ¥­å“¡ã®åŒæœŸ
  - ğŸ“Œè²¢çŒ®åº¦ã®åŒæœŸ
  - ğŸ“Œã€Œæ¡ˆä»¶ã¨å¾“æ¥­å“¡ã¨è²¢çŒ®åº¦ã€ã‚’ç´ä»˜ã‘ã‚‹åŒæœŸ
- è¡¨ç¤º
  - ğŸ™ğŸ“Œæ¡ˆä»¶ã®è¡¨ç¤ºã¨åŒæ§˜

### v2.0.4 ãƒãƒ¼ãƒ ã®è²¢çŒ®åº¦ã®è©•ä¾¡
- ä»•æ§˜æ¤œè¨
  - ğŸ¤”kintoneä¸Šã§ã€ãƒãƒ¼ãƒ ã®ç®¡ç†ã€ãƒãƒ¼ãƒ ã¨å¾“æ¥­å“¡ã®ç´ã¥ã‘ã‚’ã©ã®ã‚ˆã†ã«ç®¡ç†ã™ã‚‹ã‹ï¼Ÿ
  - ğŸ¤”kintoneä¸Šã§ã®æƒ…å ±ã¨ã€LbE_Systemä¸Šã§ã®æƒ…å ±ã‚’ã©ã®ã‚ˆã†ã«ä¸€è‡´ã•ã›ã‚‹ã‹ï¼Ÿ
- fetch
  - ğŸ“Œkintoneã®ãƒãƒ¼ãƒ ã‚’åé›†ã™ã‚‹
  - ğŸ“Œkintoneã®ãƒãƒ¼ãƒ ã¨å¾“æ¥­å“¡ã®é–¢ä¿‚æ€§ã‚’åé›†ã™ã‚‹
- sync
  - ğŸ“Œãƒãƒ¼ãƒ ã®åŒæœŸ
  - ğŸ“Œãƒãƒ¼ãƒ ã¨å¾“æ¥­å“¡ã®é–¢ä¿‚æ€§ã®åŒæœŸ
- è¡¨ç¤º
  - ğŸ“Œæ¡ˆä»¶ãƒ»äººã®è¡¨ç¤ºã¨åŒæ§˜

### v2.0.5 ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ, ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç²—åˆ©ç‡ã®è©•ä¾¡
- ï¼ˆã»ã¨ã‚“ã©ã€åŒä¸Šã®ã¯ãšï¼‰

### v2.0.a ç²—åˆ©ã®ç²¾åº¦å‘ä¸Š
- ãªã—

### v2.0.b ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãŒã§ãã‚‹ã¾ã§ã®å‡¦ç½®
- ğŸ“ŒåŒæœŸæœŸé–“ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€éå»ã®æƒ…å ±ã‚’ä¸Šæ›¸ãã—ãªã„ã‚ˆã†ã«ã™ã‚‹
  - ï¼ˆã“ã®æ–¹æ³•ã§ã‚‚ã€è²¢çŒ®åº¦ãƒã‚¹ã‚¿ã‚’æŒã¤å ´åˆã«ã¯ã€è²¢çŒ®åº¦ãƒã‚¹ã‚¿ãŒæ›´æ–°ã•ã‚Œã‚‹ã“ã¨ã§ã€éå»ã®è²¢çŒ®åº¦ã¯å¤‰ã‚ã£ã¦ã—ã¾ã„ã¾ã™ï¼‰

### v2.0.c ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
- ğŸ“ŒåŒæœŸã™ã‚‹ãŸã³ã«ã€ãã®æ™‚ç‚¹ã®æƒ…å ±ã‚’ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¨ã—ã¦ä¿å­˜ã™ã‚‹
- ğŸ“Œã™ã¹ã¦ã®ç”»é¢ã€ã™ã¹ã¦ã®ãƒ¢ãƒ‡ãƒ«ã‚’è¤‡è£½ã™ã‚‹

## ä½œæ¥­ãƒ¡ãƒ¢
### from mfçµŒè²»ã®äº‹å‰ç”³è«‹ã®æŒ¯è¾¼ä¾é ¼
- äº‹æ¥­è€…å…¨ä½“ã®ç”³è«‹ãƒªã‚¹ãƒˆã‚’è¿”ã™
  - https://expense.moneyforward.com/api/index.html#/ex_report/find_office_ex_reports
  - uri
    - /api/external/v1/offices/{office_id}/ex_reports
  - method
    - GET
  - params
    - office_id *
    - page

### TODO
- âœ…APIã®è©¦ã—æ‰“ã¡
- âœ…Choron::Moneyforward::Client
  - âœ…ex_reports_client
  - âœ…Choron::Moneyforward::Private::EXReportsClient
  - âœ…Lbe::Moneyforward::Values::ExReports::TransferRequest
  - âœ…be::Moneyforward::Client#ex_reports
- âœ…Fetch
- Sync
  - âœ…ç”³è«‹ã‹ã‚‰ã®å£²ä¸ŠåŸä¾¡ã®åŒæœŸ


## MoneyForwardã®API
https://expense.moneyforward.com/api/index.html#/

```rb
moneyforward = SystemSettings::Moneyforward.latest
credentials = moneyforward.to_credentials
client = Lbe::Moneyforward::Client.new(Rails.env.to_sym, credentials:)

from = Time.zone.parse('2023-10-29')
to = Time.zone.parse('2023-10-29')
expenses = client.expenses(from:, to:)

```

## å®Ÿè¡Œå¯èƒ½ãªCURLã‚³ãƒãƒ³ãƒ‰
### /api/external/v1/offices/{office_id}/ex_transactions
```
curl -X GET 'https://expense.moneyforward.com/api/external/v1/offices/J4t2gsevoIFChzioLajXeA/ex_transactions?query_object%5Brecognized_at_from%5D=2023-10-29&query_object%5Brecognized_at_to%5D=2023-10-29' \
> -H 'Authorization: Bearer WSAUQ1-pLr-s3LAbp3DKYWE7L2fmlbMQ_AgS-6vlYO0' \
> -H 'User-Agent: HTTPClient/1.0 (2.8.3, ruby 3.2.0 (2022-12-25))' \
> -H 'Accept: */*' \
> -H 'Date: Fri, 08 Dec 2023 02:41:15 GMT' \
> -H 'Host: expense.moneyforward.com'
```

### /api/external/v1/offices/{office_id}/ex_reports
```sh
curl -X GET 'https://expense.moneyforward.com/api/external/v1/offices/J4t2gsevoIFChzioLajXeA/ex_reports?query_object%5Brecognized_at_from%5D=2023-11-21&query_object%5Brecognized_at_to%5D=2023-11-22' \
-H 'Authorization: Bearer WSAUQ1-pLr-s3LAbp3DKYWE7L2fmlbMQ_AgS-6vlYO0' \
-H 'User-Agent: HTTPClient/1.0 (2.8.3, ruby 3.2.0 (2022-12-25))' \
-H 'Accept: */*' \
-H 'Date: Fri, 08 Dec 2023 02:41:15 GMT' \
-H 'Host: expense.moneyforward.com'
```

```sh
curl -X GET 'https://expense.moneyforward.com/api/external/v1/offices/J4t2gsevoIFChzioLajXeA/ex_reports?page=3' \
-H 'Authorization: Bearer WSAUQ1-pLr-s3LAbp3DKYWE7L2fmlbMQ_AgS-6vlYO0' \
-H 'User-Agent: HTTPClient/1.0 (2.8.3, ruby 3.2.0 (2022-12-25))' \
-H 'Accept: */*' \
-H 'Date: Fri, 08 Dec 2023 02:41:15 GMT' \
-H 'Host: expense.moneyforward.com'
```



